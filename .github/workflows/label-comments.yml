name: Issue Label Comment Bot

on:
  issues:
    types:
      - opened
      - labeled

jobs:
  comment-on-label:
    runs-on: ubuntu-latest
    steps:
      - name: Add comment based on label
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.issue;
            const label = context.payload.label ? context.payload.label.name : null;
            
            // Define label-to-comment mapping
            const labelComments = {
              'enhancement': 'Thanks for the enhancement suggestion! We appreciate your input.',
              'completed': 'This issue has been resolved. Thank you for your contribution!',
              'documentation': 'Thank you for flagging this documentation issue. We will update it soon.'
            };
            
            // Check if the issue has any of our target labels
            if (label && labelComments[label]) {
              // Check if we've already commented on this issue with this label
              const comments = await github.rest.issues.listComments({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number
              });
              
              const existingComment = comments.data.find(comment => 
                comment.body.includes(labelComments[label])
              );
              
              if (!existingComment) {
                await github.rest.issues.createComment({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: issue.number,
                  body: labelComments[label]
                });
                console.log(`Comment added for label: ${label}`);
              } else {
                console.log(`Comment already exists for label: ${label}`);
              }
            }
